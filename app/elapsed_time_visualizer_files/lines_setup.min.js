
 /*********************************************************************
 * lines_setup.js                                                     *
 *                                                                    *
 * Version: 1.2                                                       *
 * Date:    30-10-2025                              *
 * Author:  Dan Machado                                               *
 * Require  raphaeljs v2.2.1                                          *
 **********************************************************************/

const pickerSettings={headless:!0,enableAlpha:!1,enableEyedropper:!1,formats:null,defaultFormat:"hex",submitMode:"confirm",showClearButton:!1,dismissOnOutsideClick:!0,staticPlacement:"center center",staticOffset:10};var popUpAPI,objData={canvasID:"canvas",chartType:"lines",title:{text:"Elapsed Time",align:"left"},subTitle:{text:"By samples",align:"left"},gridSettings:{"line-width":1,minDataInterval:30},axisTitles:{xTitle:"Samples",yTitle:"Elapsed time (Î¼s)"},lines:[],keys:{position:"right",align:"top",onClick:function(n,a){const t=new ColorPicker(null,pickerSettings);t.on("pick",function(t){n.attr({fill:t.string("hex")});for(var e=0;e<objData.lines[a].length;e++)objData.lines[a][e].attr({stroke:t.string("hex")}),objData.colours[a]=t.string("hex")}),t.setColor(objData.colours[a]),t.prompt()}.bind(this)},serie:[],dataSet:[],colours:[],offset:0,samples:-1};function ReadCookie(){cookies={};for(var t=document.cookie.split(";"),e=0;e<t.length;e++)name=t[e].split("=")[0],cookies[name.trim()]=t[e].split("=")[1];cookies.hasOwnProperty("appInstalled")&&(document.getElementById("installBtn").disabled=!0)}chartLoader("Lines",objData),document.getElementById("loadBtn").addEventListener("change",function(t){var e=t.target.files[0];e&&((t=new FileReader).readAsText(e,"UTF-8"),t.onload=function(t){var e;try{if((e=JSON.parse(t.target.result.toString())).hasOwnProperty("dataSet")){for(var n=0;n<e.dataSet.length;n++){if(0<e.dataSet[n].data.length-objData.serie.length)for(var a=objData.serie.length;a<e.dataSet[n].data.length;a++)objData.serie.push("s"+(a+1));for(var o=0;o<objData.colours.length;o++)objData.colours[o]==e.dataSet[n].color&&(e.dataSet[n].color="#"+Math.floor(16777215*Math.random()).toString(16));objData.axisTitles.yTitle="Elapsed time ("+e.timeUnits+")",objData.colours.push(e.dataSet[n].color),objData.dataSet.push(e.dataSet[n]),0==e.dataSet[n].data.length&&alert("Data set for "+e.dataSet[n].name+" does not have any records")}reloadChar()}}catch(t){return void alert("File could not be loaded because it has bad syntax or it's corrupted.")}})}),document.getElementById("resetBtn").addEventListener("click",function(){objData.offset=0,objData.samples=-1,reloadChar()}),document.getElementById("clearBtn").addEventListener("click",function(){objData.lines=[],objData.dataSet=[],objData.serie=[],objData.colours=[],objData.offset=0,objData.samples=-1,reloadChar()}),function(){var o=0,i=0;document.getElementById("canvas").addEventListener("mousedown",function(t){o=t.offsetX}),document.getElementById("canvas").addEventListener("mouseup",function(t){if(i=t.offsetX,0<objData.serie.length&&i!=o){var e=0,n=objData.firstPoint;for(i<o&&(t=o,o=i,i=t);n<o;)n+=objData.intervalLength,e++;for(var a=e;n<i;)n+=objData.intervalLength,a++;1<a-e&&(objData.offset=e,objData.samples=a-e,reloadChar())}}),document.getElementById("openBtn").addEventListener("click",function(){window.wx_msg.postMessage("open")}),document.getElementById("installBtn").addEventListener("click",function(){window.wx_msg.postMessage("install")})}(),window.addEventListener("DOMContentLoaded",function(){var e,n,t,a;window.scrollTo(0,0),e=document.getElementById("dim"),n=document.getElementById("pop_wrapper"),t=document.getElementById("pop_up"),a=document.getElementById("popup_content"),n.style.top=.1*window.innerHeight+"px",t.style.maxHeight=.8*window.innerHeight+"px",popUpAPI={display:function(){e.style.display="block",n.style.visibility="visible"},closing:function(t){void 0===t?(n.style.visibility="hidden",e.style.display="none",document.getElementById("description").style.display="none"):t.stopPropagation()},whatisit:function(){document.getElementById("popup_title").innerHTML="Description",document.getElementById("description").style.display="block",this.display()}},document.getElementById("closePopUp").addEventListener("click",function(){popUpAPI.closing()}),e.addEventListener("click",function(){popUpAPI.closing()}),n.addEventListener("click",function(){popUpAPI.closing()}),a.addEventListener("click",function(t){popUpAPI.closing(t)}),document.getElementById("whatisit").addEventListener("click",function(){popUpAPI.whatisit()}),ReadCookie(),""==document.cookie&&(document.cookie="whatisit=yes")});