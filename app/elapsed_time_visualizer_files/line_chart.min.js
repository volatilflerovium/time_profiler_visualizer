
 /*********************************************************************
 * lines_chart.js                                                     *
 *                                                                    *
 * Version: 1.2                                                       *
 * Date:    29-04-2018 (review 20-10-2025)                              *
 * Author:  Dan Machado                                               *
 * Require  raphaeljs v2.2.1                                          *
 **********************************************************************/

function formatNumber(t,i){var e,s,h,n,i=void 0===i?2:i,t=String(t);for(-1==t.indexOf(".")&&(t+="."),0==(h=(s=(e=(t+="000000").split("."))[0].length)-3*Math.floor(s/3))&&(h=3),n=e[0].substring(0,h);h<s-1;)n+=","+e[0].substring(h,h+3),h+=3;return n+"."+e[1].substring(0,i)}function roundNumber(t,i){i="number"==typeof i?i:2;return Math.round(t*Math.pow(10,i))/Math.pow(10,i)}function CloneObject(t){if(t instanceof Object&&!(t instanceof Array))for(var i in e={},t)t.hasOwnProperty(i)&&(t[i]instanceof Object?e[i]=CloneObject(t[i]):e[i]=t[i]);else if(t instanceof Array)for(var e=[],s=t.length,h=0;h<s;h++)e[h]=t[h];return e}function complementObject(t,i){if(!(t instanceof Object)||t instanceof Array)return!(t instanceof Array);for(var e in t)t.hasOwnProperty(e)&&(void 0===i[e]&&(t[e]instanceof Object&&!(t[e]instanceof Array)?i[e]={}:i[e]=null),complementObject(t[e],i[e])&&(i[e]=t[e]))}function overWriteObj(t,i){if(t instanceof Object&&!(t instanceof Array)&&t instanceof Object&&!(t instanceof Array))for(var e in t)t.hasOwnProperty(e)&&i.hasOwnProperty(e)&&(t[e]instanceof Object?overWriteObj(t[e],i[e]):i[e]instanceof Object||(t[e]=i[e]))}function changeColor(t,i){var e=Math.abs(i);e<0&&(e+=1);for(var s,h={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},n=[0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F"],o="#",a=((t=(t=String(t)).toUpperCase()).length,1);a<4;a++)s=16*h[t[2*a-1]]+h[t[2*a]],i<0?s*=e:s=(255-s)*e+s,s=Math.round(s),o+=String(n[Math.floor(s/16)])+String(n[s-16*Math.floor(s/16)]);return o}function Paper(t){this.ID=t;var i=document.getElementById(this.ID);this.paper=Raphael(t,i.clientWidth,i.clientHeight)}function Shape(){this.obj=null}function Rect(t,i,e,s,h,n){Shape.call(this),this.obj=t.paper.rect(i,e,s,h,0),void 0!==n&&this.obj.attr(n)}function Line(t,i,e,s,h,n){Shape.call(this),this.obj=t.paper.path("M"+i+","+e+"L"+s+","+h),void 0!==n&&this.obj.attr(n)}function AnimateHBar(t,i,e,s,h,n,o){Shape.call(this),this.obj=t.paper.path("M"+i+","+e+"L"+i+","+e+"L"+i+","+(e+h)+"L"+i+","+(e+h)+"Z"),void 0!==o&&this.obj.attr(o),this.obj.animate({path:"M"+i+","+e+"L"+(i+s)+","+e+"L"+(i+s)+","+(e+h)+"L"+i+","+(e+h)+"Z"},n,"linear")}function AnimateVBar(t,i,e,s,h,n){Shape.call(this),this.obj=t.paper.path("M"+i+","+e+"L"+(i+s)+","+e+"L"+(i+s)+","+e+"L"+i+","+e+"Z"),void 0!==n&&this.obj.attr(n),this.obj.animate({path:"M"+i+","+e+"L"+(i+s)+","+e+"L"+(i+s)+","+(e-h)+"L"+i+","+(e-h)+"Z"},2e3,"linear")}function Circle(t,i,e,s,h){Shape.call(this),this.obj=t.paper.circle(i,e,s),void 0!==h&&this.obj.attr(h)}function AnimateCircle(t,i,e,s,h){Shape.call(this),this.obj=t.paper.circle(i,e,.1),void 0!==h&&this.obj.attr(h),this.obj.animate(Raphael.animation({r:s},2e3))}function Path(t,i,e){Shape.call(this),this.obj=t.paper.path(i),void 0!==e&&this.obj.attr(e)}function AnimateLine(t,i,e,s,h,n,o){Shape.call(this),this.obj=t.paper.path("M"+i+","+e),void 0!==o&&this.obj.attr(o),this.obj.animate({path:"M"+i+","+e+"L"+s+","+h},n,"linear")}function AnimatedArch(t,i,e,s,h,n,o,a,r){Shape.call(this),this.r=5,this.ms=a,this.tt=0,this.time=Date.now()+a,this.perc=e,this.initialAngle=i,this.radious=n,this.width=o,this.cx=s,this.cy=h,this.x0=(this.radious+this.width)*Math.cos(this.initialAngle)+this.cx,this.y0=(this.radious+this.width)*Math.sin(this.initialAngle)+this.cy,this.x1=this.radious*Math.cos(this.initialAngle)+s,this.y1=this.radious*Math.sin(this.initialAngle)+h,this.obj=t.paper.path("M"+this.x0+" "+this.y0+"L"+this.x1+" "+this.y1),void 0!==r&&this.obj.attr(r),this.animateArch()}function Text(t,i,e,s,h,n,o,a){var r,l;if(Shape.call(this),void 0===a)a=this.defaultStyle;else for(r in this.defaultStyle)this.defaultStyle.hasOwnProperty(r)&&!a.hasOwnProperty(r)&&(a[r]=this.defaultStyle[r]);this.Style=a,this.dummySVG.counter++,null===this.dummySVG.data&&(this.dummySVG.data=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.dummySVG.data.setAttribute("viewBox","0 0 1000 100"),this.dummySVG.data.setAttribute("preserveAspectRatio","xMidYMid meet"),document.body.appendChild(this.dummySVG.data),(p=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",-1e4),p.setAttribute("y",100),(l=document.createElementNS("http://www.w3.org/2000/svg","tspan")).setAttribute("dy",4),p.appendChild(l),this.dummySVG.data.appendChild(p)),this.strStyle.data!=a["font-size"]+a["font-weight"]+a["font-family"]+a["font-style"]&&(this.strStyle.data=a["font-size"]+a["font-weight"]+a["font-family"]+a["font-style"],this.dummySVG.data.childNodes[0].setAttributeNS(null,"font-size",a["font-size"]+"px"),this.dummySVG.data.childNodes[0].setAttributeNS(null,"font-family",a["font-family"]),this.dummySVG.data.childNodes[0].setAttributeNS(null,"font-style",a["font-style"]),this.dummySVG.data.childNodes[0].setAttributeNS(null,"font-weight",a["font-weight"]),this.dummySVG.data.childNodes[0].setAttributeNS(null,"text-anchor","start"));for(var p=(p=String(o).trim()).replace("&amp;","&"),g=(o=this.textLines(s,p)).length,d="",c=0;c<g;c++)d+=o[c],c<g-1&&(d+="\n");this.align=n,this.valign=h,a["text-anchor"]="middle",p=i+s/2,"left"==n?(a["text-anchor"]="start",p=i):"right"==n&&(a["text-anchor"]="end",p=i+s),this.obj=t.paper.text(0,e,d),this.obj.attr(a),t=this.obj.getBBox().height,t="before"==h?e-t/2:"after"==h?e+t/2:e,this.obj.attr({x:p,y:t}),this.dummySVG.counter--}function Set(){this.x=0,this.y=0,this.width=0,this.height=0,this.set=[]}function Wrapper(t,i){Shape.call(this),this.x=0,this.y=0,this.width=0,this.height=0,this.obj=t;var e=this.obj.getBBox();this.x=e.x,this.y=e.y;t=0;i.hasOwnProperty("h")?i.h>e.height&&(this.height=i.h,t=i.h-e.height,i.hasOwnProperty("valign")?t*=i.valign/100:t*=.5):i.hasOwnProperty("vPadding")?(this.height=e.height+2*i.vPadding,t=i.vPadding):this.height=e.height,0<t&&(this.y-=t),t=0,i.hasOwnProperty("w")?i.w>e.width&&(this.width=i.w,t=i.w-e.width,i.hasOwnProperty("align")?t*=i.align/100:t*=.5):i.hasOwnProperty("hPadding")?(this.width=e.width+2*i.hPadding,t=i.hPadding):this.width=e.width,0<t&&(this.x-=t)}function Row(t,i,e,s){Set.call(this),this.coordinates=[],this.sp=[],this.valignment=[],this.justifyContent="left",this.valign=0,this.w=0,this.xd=1,"number"==typeof t&&(this.width=t,this.xd=0),"number"==typeof i&&(this.height=i),"string"==typeof s&&("middle"!=s&&"bottom"!=s||("middle"==s?this.valign=1:"bottom"==s&&(this.valign=2))),0==this.xd&&"string"==typeof e&&("center"!=e&&"right"!=e&&"space-between"!=e&&"space-around"!=e||(this.justifyContent=e))}function Group(t,i,e){Set.call(this),this.currentRow=0,this.h=0,this.sil=!1,"number"==typeof i&&"inline"==t&&0<i&&(this.width=i,this.sil=!0),this.geometry="default","inline"!=t&&"stocked"!=t||(this.geometry=t),this.justifyContent="left",void 0===e&&"string"==typeof i&&(e=i),("inline"!=t||"space-between"!=e&&"space-around"!=e)&&"left"!=e&&"right"!=e&&"center"!=e||(this.justifyContent=e)}function MiniPage(t,i,e,s,h,n){void 0===n&&(n={}),this.setDefaults(n),this.paddingX=n.paddingX,this.paddingY=n.paddingY,Group.call(this,n.geometry,s-2*this.paddingX,n.justifyContent),Group.prototype.move.call(this,{x:i+this.paddingX,y:e+this.paddingY}),this.miniPage=null,n.miniPage&&(this.miniPage=new Rect(t,i,e,s,h,n))}function Grid(t){this.objData=t,this.containerID=t.canvasID,this.canvas=document.getElementById(t.canvasID),this.containerWidth=this.canvas.clientWidth,this.containerHeight=this.canvas.clientHeight,this.paddingX=10,this.paddingY=5,this.scaleFactor=1}function Lines(t){Grid.call(this,t),this.containerHeight=this.containerWidth/1.618,this.canvas.style.height=this.containerHeight+"px",this.settings={minDataInterval:35,"line-width":2,elapsedTime:2e3},this.setDefaults(),this.setPaper(),this.setKeys();var i=this.preparePanelsLR();this.x0=i.lw+this.settings.paddingC+this.settings.paddingB+this.settings.scaleArea/2,this.xAxisLength=this.containerWidth-(this.x0+this.settings.paddingA+i.rw),this.setTitle(),this.setPanelsTB();var e=this.bottomPanel.getBBox(),i=this.topPanel.getBBox();this.yAxisLength=this.containerHeight-(i.height+e.height+this.settings.paddingC+this.settings.paddingB+.6*this.settings.paddingA),this.vScale={min:1e6,max:1,minEx:null,numIntervals:null,isLogarithmic:!1,axisLength:this.yAxisLength,minVisualValue:10,intervalLength:80,factor:1,offset:t.offset,samples:t.samples},this.setScale.call(this.vScale,this.objData.dataSet,function(t,i){var e=i.length;if(!(e<1)){var s=t.samples;s<0&&(s=i[0].data.length);for(var h=0;h<e;h++)for(var n=t.offset;n<t.offset+s;n++)0<i[h].data[n]&&(t.min>Number(i[h].data[n])&&(t.min=Number(i[h].data[n])),t.max<Number(i[h].data[n])&&(t.max=Number(i[h].data[n])))}}),this.vScale.axisLength!=this.yAxisLength&&(this.containerHeight+=this.vScale.axisLength-this.yAxisLength,this.canvas.style.height=this.containerHeight+"px"),this.setPanelsLR();e=this.containerHeight-e.height;this.bottomPanel.move({y:e}),this.y0=e-(this.settings.paddingB+.6*this.settings.paddingA),this.vTransform=this.transForm.bind(this.vScale),this.vInvTransform=this.invTransForm.bind(this.vScale),this.mkVScale(this.xAxisLength),this.hScale(),t.firstPoint=this.firstPoint,t.intervalLength=this.settings.minDataInterval,this.ms=1,this.printSeries(this.objData.offset),this.paper.setSize(this.containerWidth,this.containerHeight)}!function(){var e={list:[],insert:function(t,i){"function"==typeof window[t]&&this.list.push([t,i,new window[t](i)])},reload:function(){for(var t=0;t<this.list.length;t++)document.getElementById(this.list[t][1].canvasID).innerHTML="",this.list[t][2].Reload(),this.list[t][2]=new window[this.list[t][0]](this.list[t][1])}};window.addEventListener("resize",function(){"use strict";e.reload()}),this.chartLoader=function(t,i){e.insert(t,i)},this.reloadChar=function(){e.reload()}}(),Paper.prototype.setViewBox=function(t,i,e,s,h){this.paper.setViewBox(t,i,e,s,h)},Paper.prototype.setSize=function(t,i){this.paper.setSize(t,i)},Paper.prototype.canvasSetAttribute=function(t,i){this.paper.canvas.setAttribute(t,i)},Paper.prototype.Clear=function(){document.getElementById(this.ID).innerHTML="",this.paper.clear()},Paper.prototype.getById=function(t){return this.paper.getById(t)},Paper.prototype.getDimension=function(t){var i=document.getElementById(this.ID);return"width"==t?i.clientWidth:"height"==t?i.clientHeight:void 0},Paper.prototype.defaults={text:{fill:"#000000","font-family":"inherit","font-size":12,"font-style":"normal","font-weight":"normal"}},Object.freeze(Paper.prototype.defaults),Shape.prototype.attr=function(t){this.obj.attr(t)},Shape.prototype.move=function(t){var i,e=this.obj.getBBox(),s=(t.hasOwnProperty("x")?t:e).x,h=(t.hasOwnProperty("y")?t:e).y,t=this.obj.getBBox(!0),e=0<this.obj.matrix.a?0<this.obj.matrix.b?(i=t.height*this.obj.matrix.b,0):(i=0,-1*t.width*this.obj.matrix.b):0<this.obj.matrix.b?(i=e.width,-1*t.height*this.obj.matrix.a):(i=-1*t.width*this.obj.matrix.a,e.height);s+=i,h+=e;e=this.obj.matrix.invert().x(s,h),h=this.obj.matrix.invert().y(s,h);this.obj.attr({x:e,y:h})},Shape.prototype.show=function(){this.obj.show()},Shape.prototype.hide=function(){this.obj.hide()},Shape.prototype.toFront=function(){this.obj.toFront()},Shape.prototype.toShow=function(){this.obj.show(),this.obj.toFront()},Shape.prototype.toBack=function(){this.obj.toBack()},Shape.prototype.mouseover=function(t){this.obj.mouseover(t)},Shape.prototype.mouseout=function(t){this.obj.mouseout(t)},Shape.prototype.onclick=function(t){this.obj.click(t)},Shape.prototype.getId=function(){return this.obj.id},Shape.prototype.getBBox=function(t){return"boolean"==typeof t?this.obj.getBBox(t):this.obj.getBBox()},Rect.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Rect,writable:!0}}),Line.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Line,writable:!0}}),AnimateHBar.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:AnimateHBar,writable:!0}}),AnimateVBar.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:AnimateVBar,writable:!0}}),Circle.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Circle,writable:!0}}),AnimateCircle.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:AnimateCircle,writable:!0}}),Path.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Path,writable:!0}}),AnimateLine.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:AnimateLine,writable:!0}}),AnimatedArch.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:AnimatedArch,writable:!0}}),AnimatedArch.prototype.animateArch=function(){var t,i,e,s,h;Date.now()<this.time?(this.tt=this.ms-(this.time-Date.now()),this.a=0):(this.a+=1,this.tt=this.ms),this.a<3&&(this.a++,(t=this).correction=0,setTimeout(function(){t.animateArch()},this.r),1<this.correction&&(this.correction=0),s=this.perc*(this.tt/this.ms)*.9999,i=Math.floor(.5+s/100),h=this.initialAngle+2*Math.PI*s/100,e=Math.cos(h),s=Math.sin(h),h="M"+this.x0+","+this.y0+"A"+(this.radious+this.width)+" "+(this.radious+this.width)+" 0 "+i+" 1",h+=" "+((this.radious+this.width)*e+this.cx)+" "+((this.radious+this.width)*s+this.cy),h+="L"+(this.radious*e+this.cx)+","+(this.radious*s+this.cy),h+="A"+this.radious+" "+this.radious+" 0 "+i+" 0 "+this.x1+" "+this.y1,h+="Z",this.obj.node.setAttribute("d",h))},Text.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Text,writable:!0}}),Text.prototype.strStyle={data:null},Text.prototype.dummySVG={data:null,counter:0},Text.prototype.textContainer={data:null},Text.prototype.defaultStyle={fill:"#000000","font-family":"Arial, sans-serif","font-size":12,"font-style":"normal","font-weight":"normal"},Text.prototype.textM=function(t){this.dummySVG.data.childNodes[0].childNodes[0].appendChild(document.createTextNode(t));t=this.dummySVG.data.getBBox();return this.dummySVG.data.childNodes[0].childNodes[0].removeChild(this.dummySVG.data.childNodes[0].childNodes[0].childNodes[0]),t.width},Text.prototype.trimText=function(t,i,e){var s,h,n,o="",a=(t=String(t).trim()).length;this.textM("...");if(t=t.replace("\n"," "),i>=this.textM(t))return t;for(s=0;s<a;s++){if(n=o,o+=t[s],i==(h=this.textM(o+"..."))){o="...";break}if(i<h){o=n+"...";break}}return o},Text.prototype.breakingText=function(t){var i={words:[],lengths:[],sp:0};i.sp=this.textM("a a")-2*this.textM("a"),this.spaceWidth=i.sp;for(var e,s=String(t).split(" "),h=s.length,n=0;n<h;n++)s[n]=s[n].trim(),0!=(e=this.textM(s[n]))&&(i.words.push(s[n]),i.lengths.push(e));return i},Text.prototype.textLines=function(t,i){for(var e,s,h,n=t,o=[],a=String(i).split("\n"),r=0,l=a.length,p=0;p<l;p++){for(o[r]="",n=t,h=(e=this.breakingText(a[p])).words.length,s=0;s<h;s++)n-e.lengths[s]<0&&n!=t&&(o[++r]="",n=t),0<o[r].length&&(o[r]+=" ",n-=e.sp),o[r]+=e.words[s],n-=e.lengths[s];r++}return o},Text.prototype.move=function(t){var i,e=this.obj.getBBox(),s=(t.hasOwnProperty("x")?t:e).x,h=(t.hasOwnProperty("y")?t:e).y,t=this.obj.getBBox(!0),e=0<this.obj.matrix.a?0<this.obj.matrix.b?(i=t.height*this.obj.matrix.b,0):(i=0,-1*t.width*this.obj.matrix.b):0<this.obj.matrix.b?(i=e.width,-1*t.height*this.obj.matrix.a):(i=-1*t.width*this.obj.matrix.a,e.height);s+=i,h+=e;e=this.obj.matrix.invert().x(s,h),h=this.obj.matrix.invert().y(s,h);"right"==this.align?e+=t.width:"center"==this.align&&(e+=t.width/2),h+=t.height/2,this.obj.attr({x:e,y:h})},Text.prototype.attr=function(t){delete t.x,delete t.y,this.obj.attr(t)},Set.prototype.getBBox=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},Set.prototype.move=function(t){var i,e,s,h=this.x,n=this.y;for(t.hasOwnProperty("x")&&(h=t.x),t.hasOwnProperty("y")&&(n=t.y),e=this.set.length,i=0;i<e;i++)s=this.set[i].getBBox(),this.set[i].move({x:h+s.x-this.x,y:n+s.y-this.y});this.x=h,this.y=n},Set.prototype.toShow=function(){this.looping(function(t){t.toFront(),t.show()})},Set.prototype.show=function(){this.looping(function(t){t.show()})},Set.prototype.toFront=function(){this.looping(function(t){t.toFront()})},Set.prototype.hide=function(){this.looping(function(t){t.hide()})},Set.prototype.Scale=function(i){this.looping(function(t){t.attr({transform:i})})},Set.prototype.looping=function(t){for(var i=this.set.length,e=0;e<i;e++)t(this.set[e])},Wrapper.prototype=Object.create(Shape.prototype,{constructor:{configurable:!0,enumerable:!0,value:Wrapper,writable:!0}}),Wrapper.prototype.getBBox=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},Wrapper.prototype.move=function(t){var i,e=this.x,s=this.y;t.hasOwnProperty("x")&&(e=t.x),t.hasOwnProperty("y")&&(s=t.y),t=(i=this.obj.getBBox()).x-this.x+e,i=i.y-this.y+s,this.obj.move({x:t,y:i}),this.x=e,this.y=s},Row.prototype=Object.create(Set.prototype,{constructor:{configurable:!0,enumerable:!0,value:Row,writable:!0}}),Row.prototype.insert=function(t,i){var e=0,s=this.set.length;this.set[s]=t,void 0===this.sp[s]&&(this.sp[s]=0);var h=this.set[s].getBBox();this.valignment[s]=this.valign,"string"==typeof i&&("top"==i?this.valignment[s]=0:"middle"==i?this.valignment[s]=1:"bottom"==i&&(this.valignment[s]=2));var n,o=this.x;if(this.w+=h.width,(this.xd||this.w>this.width)&&(this.width=this.w),0==this.xd&&"left"!=this.justifyContent)for(n=Math.max(0,this.width-this.w),"right"==this.justifyContent||"center"==this.justifyContent?("center"==this.justifyContent&&(n/=2),o+=n,n=0):"space-between"==this.justifyContent&&0<s?0==s?o+=n/2:n/=s:"space-around"==this.justifyContent&&(o+=(n/=s+1)/2),e=0;e<s+1;e++)o+=this.sp[e],this.set[e].move({x:o}),this.coordinates[e]=o,o+=(h=this.set[e].getBBox()).width+n;else o+=this.w-h.width,this.set[s].move({x:o}),this.coordinates[s]=o;for(var a,r=0,e=0;e<s+1;e++)r+=this.valignment[e];if(0<r){if(h=this.set[s].getBBox(),this.height>h.height){r=this.valignment[s]*(this.height-h.height)/2;this.set[s].move({x:this.coordinates[s],y:this.y+r})}else if(this.height<h.height)for(this.height=h.height,e=0;e<s+1;e++)h=this.set[e].getBBox(),a=this.y+this.valignment[e]*(this.height-h.height)/2,this.set[e].move({y:a})}else this.set[s].move({y:this.y});this.height<h.height&&(this.height=h.height)},Row.prototype.insertSpace=function(t){this.sp[this.set.length]=t,this.w+=t,(this.xd||this.w>this.width)&&(this.width+=t)},Row.prototype.move=function(t){var i,e,s;for(t.hasOwnProperty("x")&&(this.x=t.x),t.hasOwnProperty("y")&&(this.y=t.y),e=this.set.length,i=0;i<e;i++)s=this.set[i].getBBox(),s=this.y+this.valignment[i]*(this.height-s.height)/2,this.set[i].move({x:this.coordinates[i]+this.x,y:s})},Group.prototype=Object.create(Set.prototype,{constructor:{configurable:!0,enumerable:!0,value:Group,writable:!0}}),Group.prototype.insert=function(t){var i=this.set.length;this.set[i]=t;var e=this.set[i].getBBox();if("default"==this.geometry)e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.y+e.height>this.y+this.height&&(this.height=e.y+e.height-this.y),e.x+e.width>this.x+this.width&&(this.width=e.x+e.width-this.x);else if("stocked"==this.geometry){var s=this.x,h=this.y,t=0;"center"==this.justifyContent?t=1:"right"==this.justifyContent&&(t=2),s=this.x+t*(this.width-e.width)/2,this.set[i].move({x:s,y:h+this.height}),this.height+=e.height,t&&this.x>s&&(this.x=s),e.width>this.width&&(this.width=e.width)}else if("inline"==this.geometry){var n,o,a=0;if(s=this.x,0==this.sil)this.set[i].move({x:s+this.width,y:this.y}),this.width+=e.width,this.height<e.height&&(this.height=e.height);else{for(n=this.currentRow;n<i;n++)a+=this.set[n].getBBox().width;for(a+e.width>this.width?(this.currentRow=i,a=e.width,this.h=0):a+=e.width,this.h<e.height&&(this.height+=e.height-this.h,this.h=e.height),h=this.y+this.height-this.h,o=this.width-a,"left"==this.justifyContent?o=0:"right"==this.justifyContent||"center"==this.justifyContent?("center"==this.justifyContent&&(o/=2),s+=o,o=0):"space-between"==this.justifyContent&&0<i?i-this.currentRow==0?s+=o/2:o/=i-this.currentRow:"space-around"==this.justifyContent&&(s+=(o/=i+1-this.currentRow)/2),n=this.currentRow;n<i+1;n++)this.set[n].move({x:s,y:h}),s+=(e=this.set[n].getBBox()).width+o}}},Group.prototype.insertSpace=function(t){0<t&&(0==this.w&&"inline"==this.geometry?this.width+=t:this.height+=t)},MiniPage.prototype=Object.create(Group.prototype,{constructor:{configurable:!0,enumerable:!0,value:MiniPage,writable:!0}}),MiniPage.prototype.defaults={geometry:"stocked",paddingX:5,paddingY:5,miniPage:!1,justifyContent:"left"},Object.freeze(MiniPage.prototype.defaults),MiniPage.prototype.setDefaults=function(t){for(var i in this.defaults)this.defaults.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=this.defaults[i])},MiniPage.prototype.getBBox=function(t){return null!==this.miniPage?this.miniPage.getBBox(t):{x:this.x-this.paddingX,y:this.y-this.paddingY,height:this.height+2*this.paddingY,width:this.width+2*this.paddingX}},MiniPage.prototype.insertSpace=function(t){Group.prototype.insertSpace.call(this,t),null!==this.miniPage&&(t=this.getBBox(),this.height+2*this.paddingY!=t.height&&this.reSize(this.width+2*this.paddingX,this.height+2*this.paddingY))},MiniPage.prototype.insert=function(t){Group.prototype.insert.call(this,t),null!==this.miniPage&&(t=this.getBBox(),this.height+2*this.paddingY!=t.height&&this.reSize(this.width+2*this.paddingX,this.height+2*this.paddingY))},MiniPage.prototype.bound=function(t,i,e,s){var h=this.getBBox(),i=h.x+i,e=h.y+e;t.move({x:i,y:e}),"boolean"==typeof s&&!0===s&&(h=t.getBBox(),this.reSize(h.width+2*this.paddingX,h.height+2*this.paddingY))},MiniPage.prototype.reSize=function(t,i){null!==this.miniPage&&this.miniPage.attr({width:t,height:i})},MiniPage.prototype.toFront=function(){null!==this.miniPage&&this.miniPage.toFront(),Group.prototype.toFront.call(this)},MiniPage.prototype.hide=function(){null!==this.miniPage&&this.miniPage.hide(),Group.prototype.hide.call(this)},MiniPage.prototype.toShow=function(){null!==this.miniPage&&this.miniPage.toShow(),Group.prototype.toShow.call(this)},MiniPage.prototype.setStyle=function(t,i){("body"==t?this.miniPage:this.set[t]).attr(i)},MiniPage.prototype.move=function(t){var i=this.getBBox(),e=i.x,i=i.y;t.hasOwnProperty("x")&&(e=t.x),t.hasOwnProperty("y")&&(i=t.y),null!==this.miniPage&&this.miniPage.move({x:e,y:i}),Group.prototype.move.call(this,{x:e+this.paddingX,y:i+this.paddingY})},Grid.prototype.defaultSettings={gridSettings:{bgColor:"#ffffff",scaleColor:"#0000ff",labelColor:"#666666",scaleFontSize:12,scaleArea:45,"font-family":"Arial, sans-serif",popUpA:{maxWidth:200,paddingX:5,paddingY:5,justifyContent:"left",fill:"#ffffff",stroke:"#a1a1a1","stroke-width":.5,font:{fill:"#ff88ee","font-size":14,"font-style":"normal","font-weight":"normal","font-family":""}},popUpB:{maxWidth:300,paddingX:5,paddingY:5,justifyContent:"left",fill:"#000000",stroke:"#a1a1a1","stroke-width":0,font:{fill:"#ffffff","font-size":12,"font-style":"normal","font-weight":"normal","font-family":""}},extraMk:!0,mxDecimals:2},title:{fill:"#000000","font-size":22,"font-style":"normal","font-weight":"bold"},subTitle:{fill:"#000000","font-size":16,"font-style":"normal","font-weight":"normal"},axisTitles:{fill:"#a18899","font-size":16,"font-style":"normal","font-weight":"normal"},keys:{fill:"#000000","font-size":14,"font-style":"normal","font-weight":"normal"},additionalInfo:{fill:"#000000","font-size":12,"font-style":"normal","font-weight":"normal"}},Object.freeze(Grid.prototype.defaultSettings),Grid.prototype.setDefaults=function(){var t=CloneObject(this.defaultSettings.gridSettings);complementObject(this.settings,t),this.objData.hasOwnProperty("gridSettings")&&overWriteObj(t,this.objData.gridSettings);for(var i=["title","subTitle","axisTitles","keys","additionalInfo"],e=i.length,s=0;s<e;s++)t[i[s]]={},complementObject(this.defaultSettings[i[s]],t[i[s]]),t[i[s]]["font-family"]=t["font-family"],this.objData.hasOwnProperty(i[s])&&this.objData[i[s]].hasOwnProperty("font")&&overWriteObj(t[i[s]],this.objData[i[s]].font);""==t.popUpA.font["font-family"]&&(t.popUpA.font["font-family"]=t["font-family"]),""==t.popUpB.font["font-family"]&&(t.popUpB.font["font-family"]=t["font-family"]),this.settings=null,this.settings=t,this.settings.paddingA=20,this.settings.paddingB=10,this.settings.paddingC=5,this.settings.popUpA.miniPage=!0,this.settings.popUpB.miniPage=!0},Grid.prototype.setPaper=function(){this.paper=new Paper(this.containerID),this.topPanel=new MiniPage(this.paper,5,0,this.containerWidth-10,0,{paddingX:0,paddingY:this.paddingY}),this.bottomPanel=new MiniPage(this.paper,5,0,this.containerWidth-10,0,{paddingX:0,paddingY:this.paddingY}),this.popUp=new MiniPage(this.paper,0,0,100,100,this.settings.popUpA),this.popUp.hide(),this.canvas.style.backgroundColor=this.settings.bgColor},Grid.prototype.setKeys=function(){if(this.objData.hasOwnProperty("keys"))if(this.containerWidth<400&&("right"==this.objData.keys.position||"left"==this.objData.keys.position)&&(this.objData.keys.position="bottom"),"top"==this.objData.keys.position||"bottom"==this.objData.keys.position?("center"==this.objData.keys.align&&(this.objData.keys.align="space-around"),this.keyBlock=new Group("inline",this.containerWidth-2*this.paddingX,this.objData.keys.align)):this.keyBlock=new Group("stocked","left"),"columns"==this.objData.chartType||"bars"==this.objData.chartType||"donut"==this.objData.chartType||"sunburst"==this.objData.chartType||"lines"==this.objData.chartType)for(var t=this.objData.dataSet.length,i=0;i<t;i++){var e=new Row(0,0,"left");let t=new Rect(this.paper,10,10,10,10,{fill:this.objData.colours[i],"stroke-width":"0px"});var s=i;this.objData.keys.hasOwnProperty("onClick")&&t.onclick(function(t,i){return function(){this.objData.keys.onClick(t,i)}.bind(this)}(t,s)),e.insert(t),e.insertSpace(5),s="sunburst"==this.objData.chartType?this.objData.dataSet[i].name[0]:this.objData.dataSet[i].name,"donut"!=this.objData.chartType&&"sunburst"!=this.objData.chartType||(s+=" "+this.objData.dataSet[i].data[0]+"%"),e.insert(new Text(this.paper,25,5,160,"after","left",s,this.settings.keys)),"top"!=this.objData.keys.position&&"bottom"!=this.objData.keys.position||e.insertSpace(10),this.keyBlock.insert(e)}else this.objData.chartType},Grid.prototype.setTitle=function(){var t,i=1;this.objData.hasOwnProperty("title")&&(t=new Text(this.paper,0,0,this.containerWidth,"after","left",this.objData.title.text,this.settings.title),i=this.getAlignment.call(this.objData.title),this.topPanel.insert(new Wrapper(t,{w:this.containerWidth,align:i,vPadding:2}))),this.objData.hasOwnProperty("subTitle")&&(t=new Text(this.paper,0,0,this.containerWidth,"after","left",this.objData.subTitle.text,this.settings.subTitle),i=this.getAlignment.call(this.objData.subTitle),this.topPanel.insert(new Wrapper(t,{w:this.containerWidth,align:i,vPadding:1})))},Grid.prototype.getAlignment=function(){var t=1;return this.hasOwnProperty("align")&&("right"==this.align?t=99:"center"==this.align&&(t=50)),t},Grid.prototype.setPanelsTB=function(){this.objData.hasOwnProperty("axisTitles")&&void 0!==this.objData.axisTitles.xTitle&&(this.xTitle=new Wrapper(new Text(this.paper,0,0,this.containerWidth,"after","left",this.objData.axisTitles.xTitle,this.settings.axisTitles),{w:this.containerWidth,align:55,vPadding:5}),this.bottomPanel.insert(this.xTitle)),this.objData.hasOwnProperty("keys")&&("top"==this.objData.keys.position?this.topPanel.insert(this.keyBlock):"bottom"==this.objData.keys.position&&this.bottomPanel.insert(this.keyBlock)),this.objData.hasOwnProperty("additionalInfo")&&(aling=this.getAlignment.call(this.objData.additionalInfo[void 0]),("top"==this.objData.additionalInfo.position?this.topPanel:this.bottomPanel).insert(new Wrapper(new Text(this.paper,0,0,this.containerWidth,"after","left",this.objData.additionalInfo.content,this.settings.additionalInfo),{w:this.containerWidth,align:void 0,vPadding:5}))),this.bottomPanel.insertSpace(5),this.topPanel.move({x:5,y:0})},Grid.prototype.preparePanelsLR=function(){var t,i=0,e=0,s=0,h=0;return this.objData.hasOwnProperty("keys")&&("left"==this.objData.keys.position?(i=(t=this.keyBlock.getBBox()).width,e=t.height):"right"==this.objData.keys.position&&(s=(t=this.keyBlock.getBBox()).width,h=t.height)),this.objData.hasOwnProperty("axisTitles")&&void 0!==this.objData.axisTitles.yTitle&&(this.yTitle=new Text(this.paper,0,0,this.containerWidth,"after","left",this.objData.axisTitles.yTitle,this.settings.axisTitles),this.yTitle.attr({transform:"r-90,10,10"}),i+=(t=this.yTitle.getBBox()).width+this.paddingX,e=Math.max(e,t.height)),{lw:i,lh:e,rw:s,rh:h}},Grid.prototype.setPanelsLR=function(){var t=this.containerHeight-(this.bottomPanel.height+this.topPanel.height);this.leftPanel=new Row(0,t),this.leftPanel.insertSpace(this.paddingX),this.rightPanel=new Row(0,t),this.rightPanel.insertSpace(this.paddingX),this.objData.hasOwnProperty("keys")&&(t="top",this.objData.keys.hasOwnProperty("align")&&(t=this.objData.keys.align),"left"==this.objData.keys.position?(this.leftPanel.insert(this.keyBlock,t),this.leftPanel.insertSpace(this.paddingX)):"right"==this.objData.keys.position&&(this.rightPanel.insert(this.keyBlock,t),this.rightPanel.insertSpace(this.paddingX))),this.objData.hasOwnProperty("axisTitles")&&void 0!==this.objData.axisTitles.yTitle&&(this.leftPanel.insert(this.yTitle,"middle"),this.leftPanel.insertSpace(this.paddingX)),this.leftPanel.move({y:this.topPanel.height}),this.rightPanel.move({x:this.containerWidth-this.rightPanel.getBBox().width,y:this.topPanel.height})},Grid.prototype.getScaleValues=function(t){var i=t;return t<1e-6?i=String(1e7*t)+"/10M":t<1e-5?i=String(1e6*t)+"/1M":t<1e-4?i=String(1e5*t)+"/100k":t<.001?i=String(1e4*t)+"/10k":t<.01?i=String(1e3*t)+"/1k":1e6<=t?i=String(t/1e6)+"M":1e3<=t&&(i=String(t/1e3)+"k"),i},Grid.prototype.mkVScale=function(t){for(var i=0,e=this.x0-this.settings.scaleArea-this.settings.paddingB;i<this.vScale.axisLength;)new Line(this.paper,this.x0,this.y0-i,this.x0+t,this.y0-i,{stroke:this.settings.scaleColor}),0<i&&new Text(this.paper,e,this.y0-i,this.settings.scaleArea,"middle","right",this.getScaleValues(this.vInvTransform(i)),{fill:this.settings.labelColor,"font-size":this.settings.scaleFontSize,"font-family":this.settings["font-family"]}),i+=this.vScale.intervalLength;i=this.vScale.axisLength,new Text(this.paper,e,this.y0-i,this.settings.scaleArea,"middle","right",this.getScaleValues(this.vInvTransform(i)),{fill:this.settings.labelColor,"font-size":this.settings.scaleFontSize,"font-family":this.settings["font-family"]}),new Line(this.paper,this.x0,this.y0-i,this.x0+t,this.y0-i,{stroke:this.settings.scaleColor})},Grid.prototype.mkHScale=function(t){for(var i,e,s,h=0;h<this.hScale.axisLength;)new Line(this.paper,this.x0+h,this.y0-t,this.x0+h,this.y0,{stroke:this.settings.scaleColor}),0<h&&(s=(e=(i=new Text(this.paper,this.x0+h,this.y0+this.settings.paddingC,this.settings.scaleArea,"after","left",this.getScaleValues(this.hInvTransform(h)),{fill:this.settings.labelColor,"font-size":this.settings.scaleFontSize,"font-family":this.settings["font-family"]})).getBBox()).x-e.width/2,i.move({x:s})),h+=this.hScale.intervalLength;h=this.hScale.axisLength,s=(e=(i=new Text(this.paper,this.x0+h,this.y0+this.settings.paddingC,this.settings.scaleArea,"after","left",this.getScaleValues(this.hInvTransform(h)),{fill:this.settings.labelColor,"font-size":this.settings.scaleFontSize,"font-family":this.settings["font-family"]})).getBBox()).x-e.width/2,i.move({x:s}),new Line(this.paper,this.x0+h,this.y0-t,this.x0+h,this.y0,{stroke:this.settings.scaleColor})},Grid.prototype.transForm=function(t){return 0<t?this.isLogarithmic?this.factor*(Math.log10(t)+1-this.minEx):this.factor*t:0},Grid.prototype.invTransForm=function(t,i){i=roundNumber(t/this.factor,i);return this.isLogarithmic?Math.pow(10,this.minEx-1+i):i},Grid.prototype.setScale=function(t,i){if(i(this,t),this.max<this.min&&(this.max=this.min),this.minVisualValue>this.min*this.axisLength/this.max){this.isLogarithmic=!0;t=Math.ceil(Math.log10(this.max));this.minEx=Math.ceil(Math.log10(this.min))-1,t==this.minEx&&this.minEx--,this.numIntervals=t-this.minEx+1,this.intervalLength=this.axisLength/this.numIntervals,this.intervalLength<40&&(this.intervalLength=40,this.axisLength=40*this.numIntervals),this.factor=this.axisLength/(t-this.minEx+1)}else{this.factor=this.axisLength/this.max;for(var e=this.intervalLength/this.factor,s=Math.pow(10,Math.ceil(Math.log10(e))),h=[10,5,4,2],n=s,o=0;o<h.length;o++)if(e<s/h[o]){n=s/h[o];break}(h=Math.ceil(this.max/n)*n)==this.max&&this.extraMk&&(h+=.25*n),this.factor=this.axisLength/h,this.intervalLength=n*this.factor}},Grid.prototype.printcategory=function(t,i,e,s,h,n,o,a){var r,l,p,g,d,c=new Text(this.paper,-1500,0,this.settings.popUpB.maxWidth,"after","left",t,this.settings.popUpB.font),f=c.trimText(t,s,{"font-size":this.settings.categoryFontSize,"font-family":this.settings["font-family"]}),n=new Text(this.paper,i,e,s,h,n,f,{fill:this.settings.labelColor,"font-size":this.settings.categoryFontSize,"font-family":this.settings["font-family"]});f!=t&&(r=this.settings.popUpB,l=(d=c.getBBox()).width+2*r.paddingX,p=d.height+2*r.paddingY,g=this.scaleFactor,d=null,n.mouseover(function(t){null==d&&(i=3+t.clientX-document.getElementById(a).getBoundingClientRect().left,e=3+t.clientY-document.getElementById(a).getBoundingClientRect().top,d=1,i+l>document.getElementById(a).getBoundingClientRect().right&&(i-=l),i*=g,e*=g,o.setStyle("body",r),o.reSize(l,p),o.move({x:i,y:e}),o.toShow(),o.bound(c,r.paddingX,r.paddingY),c.toShow())}),n.mouseout(function(){c.hide(),o.hide(),d=null}))},Grid.prototype.moveLabel=function(t,i,e,s,h){var n=document.getElementById(this.containerID).getBoundingClientRect(),o=10+t.clientX;o+i>n.right&&(o-=i+10),o-=n.left,o*=this.scaleFactor;t=10+t.clientY;t+e>n.bottom&&(t-=e+10),t-=n.top,t*=this.scaleFactor,this.popUp.setStyle("body",this.settings.popUpA),this.popUp.reSize(i,e),this.popUp.move({x:o,y:t}),this.popUp.toShow(),this.popUp.bound(s,this.settings.popUpA.paddingX,this.settings.popUpA.paddingY),s.toShow()},Grid.prototype.scaleDown=function(){this.paper.setSize(this.containerWidth,this.containerHeight),this.paper.setViewBox(0,0,this.scaleFactor*this.containerWidth,this.scaleFactor*this.containerHeight,!0),this.canvas.style.height=this.containerHeight/this.scaleFactor+"px"},Grid.prototype.Reload=function(){this.paper.Clear()},Lines.prototype=Object.create(Grid.prototype,{constructor:{configurable:!0,enumerable:!0,value:Lines,writable:!0}}),Lines.prototype.hScale=function(){for(var t=this.objData.serie.length,i=t=0<this.objData.samples?this.objData.samples:t,e=(this.xAxisLength-this.settings.paddingA)/(i-1),s=1;this.settings.minDataInterval>e;)s++,i=Math.floor(t/s),e=(this.xAxisLength-this.settings.paddingA)/i;this.settings.minDataInterval=(this.xAxisLength-this.settings.paddingA)/(t-1),this.firstPoint=this.x0+this.settings.paddingA/2;for(var h=this.firstPoint,n=this.objData.offset;n<this.objData.offset+t;n++)n%s==0&&(new Line(this.paper,h,this.y0+5,h,this.y0,{stroke:this.settings.scaleColor}),this.printcategory(this.objData.serie[n],h-this.settings.scaleArea/2,this.y0+2+this.settings.scaleFontSize,this.settings.scaleArea,"after","center",this.popUp,this.containerID)),h+=this.settings.minDataInterval},Lines.prototype.printSeries=function(t){var i=this.objData.serie.length;0<this.objData.samples&&(i=this.objData.samples);for(var e=this.objData.dataSet.length,s=t,h=0;h<e;h++){var n,o,a=this.firstPoint+(t-this.objData.offset)*this.settings.minDataInterval,r=this.y0-this.vTransform(this.objData.dataSet[h].data[s]);this.recordPoint(s,h,a,r),s<this.objData.offset+i-1&&(n=a+this.settings.minDataInterval,o=this.y0-this.vTransform(this.objData.dataSet[h].data[s+1]),o=new AnimateLine(this.paper,a,r,n,o,this.ms,{stroke:this.objData.colours[h],"stroke-width":this.settings["line-width"]+"px"}),0==s&&(this.objData.lines[h]=[]),this.objData.lines[h].push(o))}s<this.objData.offset+i-1&&setTimeout(function(){this.printSeries(++s)}.bind(this),2)},Lines.prototype.recordPoint=function(a,r,l,p){!function(){setTimeout(function(){var t=this.popUp,i=(this.objData,new Group("stocked",this.settings.popUpA.justifyContent));i.insert(new Text(this.paper,-500,this.y0,this.settings.popUpA.maxWidth,"after","left",this.objData.serie[a],{fill:this.settings.popUpA.font.fill,"font-size":this.settings.popUpA.font["font-size"],"font-style":this.settings.popUpA.font["font-style"],"font-weight":"bold","font-family":this.settings.popUpA["font-family"]})),i.insertSpace(5),e=this.objData.dataSet[r].name+" "+formatNumber(this.objData.dataSet[r].data[a],this.settings.mxDecimals),i.insert(new Text(this.paper,-500,0,this.settings.popUpA.maxWidth,"after","left",e,this.settings.popUpA.font)),i.hide();var e=i.getBBox(),s=e.width,h=e.height;h+=2*this.settings.popUpA.paddingX,s+=2*this.settings.popUpA.paddingY;var n=new Circle(this.paper,l,p,1.75*this.settings["line-width"],{fill:this.objData.colours[r],"stroke-width":8,stroke:this.objData.colours[r],"stroke-opacity":0}),o=null;n.mouseover(function(t){null==o&&(n.attr({"stroke-opacity":.5}),o=1,this.moveLabel(t,s,h,i,function(t,i){}))}.bind(this)),n.mouseout(function(){n.attr({"stroke-opacity":0}),i.hide(),t.hide(),o=null})}.bind(this),100)}.bind(this)()};